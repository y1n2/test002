==========================================
freeDiameter Windows ç¼–è¯‘å®Œæ•´æŒ‡å—
==========================================

ğŸ¯ ç›®æ ‡ï¼šåœ¨ Windows ç³»ç»Ÿä¸Šç¼–è¯‘ freeDiameter å®¢æˆ·ç«¯

ğŸ“ æºä»£ç ä½ç½®ï¼šD:\freeDiameter_Windows_Source

==========================================
ğŸ“‹ ç¼–è¯‘ç¯å¢ƒè¦æ±‚
==========================================

æ–¹æ³•1ï¼šVisual Studioï¼ˆæ¨èï¼‰
âœ… Visual Studio 2019 æˆ– 2022ï¼ˆCommunity ç‰ˆæœ¬å…è´¹ï¼‰
âœ… CMake 3.10 æˆ–æ›´æ–°ç‰ˆæœ¬
âœ… Windows 10/11 64ä½ç³»ç»Ÿ

æ–¹æ³•2ï¼šMinGW-w64
âœ… MinGW-w64 ç¼–è¯‘å™¨
âœ… CMake 3.10 æˆ–æ›´æ–°ç‰ˆæœ¬
âœ… MSYS2ï¼ˆæ¨èï¼‰

==========================================
ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆæ¨èæ–¹å¼ï¼‰
==========================================

1. ä¸‹è½½å®‰è£… Visual Studio Community
   https://visualstudio.microsoft.com/zh-hans/vs/community/
   
   å®‰è£…æ—¶é€‰æ‹©ï¼š
   - C++ æ¡Œé¢å¼€å‘å·¥ä½œè´Ÿè½½
   - Windows 10/11 SDK
   - CMake å·¥å…·

2. ä¸‹è½½å®‰è£… CMake
   https://cmake.org/download/
   
   å®‰è£…æ—¶é€‰æ‹©"Add CMake to system PATH"

3. æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰
   cd D:\freeDiameter_Windows_Source
   
4. è¿è¡Œç¼–è¯‘è„šæœ¬
   build.bat

==========================================
ğŸ“ è¯¦ç»†ç¼–è¯‘æ­¥éª¤
==========================================

æ­¥éª¤1ï¼šç¯å¢ƒæ£€æŸ¥
-----------------
æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œæ£€æŸ¥å·¥å…·æ˜¯å¦å®‰è£…ï¼š
cmake --version
cl

å¦‚æœ cl å‘½ä»¤ä¸å¯ç”¨ï¼Œéœ€è¦è®¾ç½® Visual Studio ç¯å¢ƒï¼š
"C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build\vcvars64.bat"

æ­¥éª¤2ï¼šç”Ÿæˆé¡¹ç›®æ–‡ä»¶
-----------------
cd D:\freeDiameter_Windows_Source
mkdir build
cd build
cmake .. -G "Visual Studio 17 2022" -A x64

æ­¥éª¤3ï¼šç¼–è¯‘é¡¹ç›®
-----------------
cmake --build . --config Release

æ­¥éª¤4ï¼šå¤åˆ¶é…ç½®æ–‡ä»¶
-----------------
copy ..\config\client.conf Release\
xcopy ..\certs Release\certs\ /E /I /Y

==========================================
ğŸ› ï¸ ç¼–è¯‘è„šæœ¬ä½¿ç”¨
==========================================

æ–¹å¼1ï¼šæ‰¹å¤„ç†è„šæœ¬ï¼ˆWindows å‘½ä»¤æç¤ºç¬¦ï¼‰
cd D:\freeDiameter_Windows_Source
build.bat

æ–¹å¼2ï¼šPowerShell è„šæœ¬
cd D:\freeDiameter_Windows_Source
PowerShell -ExecutionPolicy Bypass -File build.ps1

æ–¹å¼3ï¼šæ‰‹åŠ¨ç¼–è¯‘
æŒ‰ç…§ä¸Šè¿°è¯¦ç»†ç¼–è¯‘æ­¥éª¤æ“ä½œ

==========================================
ğŸ“‚ ç¼–è¯‘åæ–‡ä»¶ç»“æ„
==========================================

D:\freeDiameter_Windows_Source\
â”œâ”€â”€ build\
â”‚   â”œâ”€â”€ Release\
â”‚   â”‚   â”œâ”€â”€ diameter_client.exe    â† ä¸»è¦å¯æ‰§è¡Œæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ client.conf            â† é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ certs\                 â† è¯ä¹¦ç›®å½•
â”‚   â””â”€â”€ Debug\                     â† è°ƒè¯•ç‰ˆæœ¬ï¼ˆå¦‚æœç¼–è¯‘ï¼‰
â”œâ”€â”€ src\                           â† æºä»£ç 
â”œâ”€â”€ include\                       â† å¤´æ–‡ä»¶
â”œâ”€â”€ config\                        â† åŸå§‹é…ç½®æ–‡ä»¶
â”œâ”€â”€ certs\                         â† åŸå§‹è¯ä¹¦æ–‡ä»¶
â”œâ”€â”€ CMakeLists.txt                 â† CMake é…ç½®
â”œâ”€â”€ build.bat                      â† æ‰¹å¤„ç†ç¼–è¯‘è„šæœ¬
â””â”€â”€ build.ps1                      â† PowerShell ç¼–è¯‘è„šæœ¬

==========================================
ğŸ”§ é…ç½®å®¢æˆ·ç«¯
==========================================

ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼šbuild\Release\client.conf

é‡è¦é…ç½®é¡¹ï¼š
# å®¢æˆ·ç«¯èº«ä»½
Identity = "client.example.com";
Realm = "example.com";

# ç½‘ç»œè®¾ç½®
ListenOn = "127.0.0.1";
Port = 3869;
SecPort = 3870;

# è¿æ¥æœåŠ¡ç«¯ï¼ˆWSL Ubuntuï¼‰
ConnectPeer = "server.example.com" { 
    ConnectTo = "127.0.0.1"; 
    Port = 3868; 
    No_TLS; 
};

==========================================
ğŸš€ è¿è¡Œå®¢æˆ·ç«¯
==========================================

å‰ææ¡ä»¶ï¼š
1. WSL Ubuntu æœåŠ¡ç«¯æ­£åœ¨è¿è¡Œ
   åœ¨ WSL ä¸­æ‰§è¡Œï¼š
   cd /home/zhuwuhui/freeDiameter/exe
   ./start_server.sh

2. æ£€æŸ¥ç«¯å£å ç”¨
   netstat -an | findstr 3868

è¿è¡Œå®¢æˆ·ç«¯ï¼š
cd D:\freeDiameter_Windows_Source\build\Release
diameter_client.exe --conf client.conf

æˆ–è€…ä½¿ç”¨è¯¦ç»†æ—¥å¿—ï¼š
diameter_client.exe --conf client.conf --dbg_all

==========================================
ğŸ” æ•…éšœæ’é™¤
==========================================

é—®é¢˜1ï¼šCMake é…ç½®å¤±è´¥
è§£å†³ï¼š
- ç¡®ä¿ Visual Studio æ­£ç¡®å®‰è£…
- æ£€æŸ¥ CMake ç‰ˆæœ¬ï¼ˆéœ€è¦ 3.10+ï¼‰
- ç¡®è®¤ç³»ç»Ÿ PATH è®¾ç½®

é—®é¢˜2ï¼šç¼–è¯‘é”™è¯¯
è§£å†³ï¼š
- æ£€æŸ¥ Windows SDK æ˜¯å¦å®‰è£…
- å°è¯•ä¸åŒçš„ Visual Studio ç‰ˆæœ¬
- æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼šcmake --build . --config Release --verbose

é—®é¢˜3ï¼šè¿è¡Œæ—¶é”™è¯¯
è§£å†³ï¼š
- ç¡®ä¿é…ç½®æ–‡ä»¶è·¯å¾„æ­£ç¡®
- æ£€æŸ¥è¯ä¹¦æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- éªŒè¯ç½‘ç»œè¿æ¥

é—®é¢˜4ï¼šè¿æ¥æœåŠ¡ç«¯å¤±è´¥
è§£å†³ï¼š
- ç¡®è®¤ WSL Ubuntu æœåŠ¡ç«¯æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- éªŒè¯ç«¯å£é…ç½®ï¼ˆå®¢æˆ·ç«¯3869ï¼ŒæœåŠ¡ç«¯3868ï¼‰
- ä½¿ç”¨ telnet 127.0.0.1 3868 æµ‹è¯•è¿æ¥

é—®é¢˜5ï¼šæƒé™é”™è¯¯
è§£å†³ï¼š
- ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå‘½ä»¤æç¤ºç¬¦
- æ£€æŸ¥æ–‡ä»¶æƒé™
- ç¡®ä¿é˜²ç—…æ¯’è½¯ä»¶ä¸é˜»æ­¢

==========================================
ğŸ“Š æ€§èƒ½ä¼˜åŒ–
==========================================

å‘å¸ƒç‰ˆæœ¬ç¼–è¯‘ï¼š
cmake --build . --config Release

è°ƒè¯•ç‰ˆæœ¬ç¼–è¯‘ï¼š
cmake --build . --config Debug

é™æ€é“¾æ¥ï¼ˆå‡å°‘ä¾èµ–ï¼‰ï¼š
åœ¨ CMakeLists.txt ä¸­æ·»åŠ ï¼š
set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded")

==========================================
ğŸ”„ æ›´æ–°å’Œç»´æŠ¤
==========================================

æ›´æ–°æºä»£ç ï¼š
1. ä» WSL å¤åˆ¶æ–°çš„æºä»£ç 
2. é‡æ–°è¿è¡Œæ‰“åŒ…è„šæœ¬
3. é‡æ–°ç¼–è¯‘

æ¸…ç†æ„å»ºï¼š
rmdir /s build
mkdir build

å®Œå…¨é‡æ–°ç¼–è¯‘ï¼š
build.bat

==========================================
âœ… éªŒè¯ç¼–è¯‘æˆåŠŸ
==========================================

æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶ï¼š
dir build\Release\diameter_client.exe

æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆåº”è¯¥ > 100KBï¼‰ï¼š
dir build\Release\diameter_client.exe

æ£€æŸ¥ä¾èµ–ï¼ˆå¯é€‰ï¼‰ï¼š
dumpbin /dependents build\Release\diameter_client.exe

æµ‹è¯•è¿è¡Œï¼š
build\Release\diameter_client.exe --help

==========================================
ğŸ“ æŠ€æœ¯æ”¯æŒ
==========================================

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ç¼–è¯‘æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
2. ç¡®è®¤æ‰€æœ‰ä¾èµ–éƒ½å·²å®‰è£…
3. å°è¯•ä¸åŒçš„ç¼–è¯‘é…ç½®
4. æŸ¥çœ‹ Windows äº‹ä»¶æ—¥å¿—

å¸¸ç”¨è°ƒè¯•å‘½ä»¤ï¼š
- cmake --version
- cl
- where cmake
- where cl

==========================================
ğŸ‰ æ€»ç»“
==========================================

ä¼˜åŠ¿ï¼š
âœ… åŸç”Ÿ Windows æ€§èƒ½
âœ… å®Œå…¨å…¼å®¹ Windows ç‰¹æ€§
âœ… å¯ä½¿ç”¨ Visual Studio è°ƒè¯•
âœ… æ”¯æŒå¤šç§ç¼–è¯‘ç¯å¢ƒ

æ–‡ä»¶æ¸…å•ï¼š
- diameter_client.exeï¼ˆä¸»ç¨‹åºï¼‰
- client.confï¼ˆé…ç½®æ–‡ä»¶ï¼‰
- certs\ï¼ˆè¯ä¹¦ç›®å½•ï¼‰
- ç¼–è¯‘è„šæœ¬å’Œæ–‡æ¡£

ä¸‹ä¸€æ­¥ï¼š
1. å¯åŠ¨ WSL Ubuntu æœåŠ¡ç«¯
2. è¿è¡Œ Windows å®¢æˆ·ç«¯
3. æµ‹è¯• Diameter é€šä¿¡

==========================================
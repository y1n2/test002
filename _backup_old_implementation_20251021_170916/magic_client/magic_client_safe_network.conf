# MAGIC Client Configuration File - 安全网络配置版本
# ================================
# 
# 这是一个使用安全网络配置的MAGIC客户端配置文件
# 使用虚拟接口和独立子网避免与现有网络配置冲突

# Server Configuration
# ===================
server = {
    # Server hostname or IP address
    hostname = "192.168.1.33";
    
    # Server port (default Diameter port is 3868)
    port = 3869;
    
    # Enable TLS encryption (recommended)
    use_tls = false;
    
    # Connection timeouts (in seconds)
    connect_timeout = 30;
    response_timeout = 60;
    
    # Maximum connection retry attempts
    max_retries = 3;
};

# Authentication Configuration
# ===========================
auth = {
    # Unique client identifier
    client_id = "magic_client_001";
    
    # User credentials
    username = "test_user";
    password = "test_password";
    
    # Authentication realm
    realm = "magic.example.com";
    
    # Authentication timeout (in seconds)
    auth_timeout = 30;
    
    # Auto reconnect on connection loss
    auto_reconnect = true;
    
    # Reconnect interval (in seconds)
    reconnect_interval = 10;
};

# Network Configuration - 安全的链路模拟器连接配置
# ================================================
network = {
    # 使用虚拟接口避免冲突
    preferred_interface = "magic0";
    
    # 启用自动选择接口（如果虚拟接口不可用）
    auto_select_interface = true;
    
    # 启用备份原始网络配置
    backup_original_config = true;
    
    # 启用退出时恢复配置
    restore_on_exit = true;
    
    # 网络连通性测试超时
    network_test_timeout = 10;
    
    # 带宽限制（0表示无限制）
    bandwidth_limit = 0;
    
    # 测试主机用于连通性验证
    test_hosts = [
        "127.0.0.1",  # 本地回环，用于测试链路模拟器连接
        "8.8.8.8",    # 备用外部连通性测试
        "1.1.1.1"     # 备用外部连通性测试
    ];
    
    # 链路模拟器连接配置
    link_simulator = {
        # 链路模拟器IP地址
        simulator_ip = "127.0.0.1";
        
        # 客户端虚拟网络配置（使用独立子网）
        virtual_network = {
            # 使用172.20.0.0/24子网避免冲突
            client_ip = "172.20.0.100";
            netmask = "255.255.255.0";
            gateway = "172.20.0.1";
            
            # DNS配置
            dns_primary = "8.8.8.8";
            dns_secondary = "8.8.4.4";
        };
        
        # 链路端口配置
        ports = {
            ethernet = 10001;
            wifi = 10002;
            cellular = 10003;
            satellite = 10004;
        };
    };
};

# Proxy Configuration
# ==================
proxy = {
    # Enable local proxy server
    enable_proxy = false;
    
    # Proxy server port
    proxy_port = 8080;
    
    # Bind address (127.0.0.1 for localhost only)
    bind_address = "127.0.0.1";
    
    # Maximum concurrent connections
    max_connections = 100;
    
    # Connection timeout (in seconds)
    connection_timeout = 30;
    
    # Log proxy requests
    log_requests = false;
};

# Logging Configuration
# ====================
logging = {
    # Log level: DEBUG, INFO, NOTICE, WARNING, ERROR
    level = "INFO";
    
    # Log file path (empty for stdout)
    file = "/tmp/magic_client.log";
    
    # Maximum log file size (MB)
    max_size = 10;
    
    # Number of log files to keep
    max_files = 5;
    
    # Enable timestamp in logs
    timestamp = true;
    
    # Enable function name in logs
    function_name = true;
};

# Security Configuration
# ======================
security = {
    # Enable certificate validation
    validate_certificates = false;
    
    # Certificate file path
    cert_file = "";
    
    # Private key file path
    key_file = "";
    
    # CA certificate file path
    ca_file = "";
    
    # Enable hostname verification
    verify_hostname = false;
};

# Monitoring Configuration
# =======================
monitoring = {
    # Enable performance monitoring
    enable_monitoring = true;
    
    # Statistics collection interval (seconds)
    stats_interval = 60;
    
    # Enable connection health checks
    health_checks = true;
    
    # Health check interval (seconds)
    health_check_interval = 30;
    
    # Enable bandwidth monitoring
    bandwidth_monitoring = true;
    
    # Bandwidth monitoring interval (seconds)
    bandwidth_interval = 10;
};

# Advanced Network Configuration
# =============================
advanced_network = {
    # 虚拟接口创建配置
    virtual_interface = {
        # 接口名称
        name = "magic0";
        
        # 接口类型 (tun/tap)
        type = "tun";
        
        # 自动创建接口
        auto_create = true;
        
        # 自动删除接口
        auto_delete = true;
    };
    
    # 路由配置
    routing = {
        # 添加到链路模拟器的路由
        add_simulator_routes = true;
        
        # 路由表ID
        table_id = 100;
        
        # 路由优先级
        priority = 1000;
    };
    
    # 防火墙配置
    firewall = {
        # 启用防火墙规则管理
        manage_rules = false;
        
        # 允许链路模拟器连接
        allow_simulator = true;
        
        # 规则链名称
        chain_name = "MAGIC_CLIENT";
    };
};
# freeDiameter configuration file for MAGIC Client

# Identity of the client
Identity = "magic-client.example.com";
Realm = "example.com";

# MAGIC Application ID (1094202169) - ARINC 839-2014
# This client supports MAGIC vendor-specific application
# Vendor-ID: 44008 (AEEC), Auth-Application-Id: 1094202169

ListenOn = "192.168.10.5";

# Disable SCTP, use TCP
No_SCTP; 

# 禁用IPv6，只使用IPv4
No_IPv6;
AppServThreads = 1;
NoRelay;

Port = 0; # Listen on a random port
SecPort = 0;


# TLS settings: absolute paths to certs
TLS_Cred = "/home/zhuwuhui/freeDiameter/cert/client.crt", "/home/zhuwuhui/freeDiameter/cert/client.key";
TLS_CA = "/home/zhuwuhui/freeDiameter/cert/ca.crt";

# 符合 ARINC 822A/830/842 的 TLS 安全配置
# - 强制 TLS 1.2+（禁用 TLS 1.0/1.1）
# - 禁用弱加密算法（MD5, SHA1, 3DES, RC4）
# - 优先使用 AES-256-GCM 和 AES-128-GCM
# - 启用完全前向安全性（ECDHE）
TLS_Prio = "SECURE256:+SECURE128:-VERS-TLS1.0:-VERS-TLS1.1:-MD5:-SHA1:-3DES-CBC:-ARCFOUR-128:%SAFE_RENEGOTIATION";

# 证书吊销列表检查（可选，需要定期更新 CRL 文件）
# TLS_CRL = "/home/zhuwuhui/freeDiameter/certs/ca.crl";

# DH 密钥交换参数（建议 2048 位以上）
TLS_DH_Bits = 2048;


# 1. 加载 MAGIC 协议字典（包含应用 ID 声明）
#    dict_magic_839 会自动调用 fd_disp_app_support() 注册应用支持
#    客户端只需加载字典，不需要加载服务端的 app_magic.fdx
LoadExtension = "/home/zhuwuhui/freeDiameter/build/extensions/dict_magic_839.fdx";

# 2. 调试消息转储
LoadExtension = "/home/zhuwuhui/freeDiameter/build/extensions/dbg_msg_dumps.fdx" : "0x0080";

# 可选：如需NASREQ可再加载（示例，默认不启用）
# LoadExtension = "/home/zhuwuhui/freeDiameter/exe/dict_nasreq.fdx";

# Connect to the MAGIC server over TLS (separate TLS port)
ConnectPeer = "magic-server.example.com" { ConnectTo = "192.168.126.1"; Port = 5870; };


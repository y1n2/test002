# ========================================================
# efb-01_magic.conf
# ARINC 839-2014 MAGIC Diameter 客户端业务配置文件
# Auto-generated by cert_generator.py v1.2.2 at 2025-12-30 14:55:46
# ========================================================

# --------------------- 基本身份信息 ---------------------
CLIENT_ID           = EFB-01.B-929A.CES                          # 设备唯一ID，必须与 freeDiameter Identity 一致
TAIL_NUMBER         = B-929A                 # 飞机注册号
AIRCRAFT_TYPE       = C929               # 机型

# --------------------- Diameter 路由信息 ---------------------
DESTINATION_REALM   = example.com                # 地面服务器 Realm

# --------------------- 会话业务核心参数 ---------------------
PROFILE_NAME        = IP_DATA                # 会话类型：IP_DATA / VOICE / VIDEO_STREAM / SAFETY

REQUESTED_BW        = 12000000                # 请求下行带宽
REQUESTED_RETURN_BW = 3000000         # 请求上行带宽
REQUIRED_BW         = 4000000                 # 最低保障下行
REQUIRED_RETURN_BW  = 1000000          # 最低保障上行

QOS_LEVEL           = 2                   # QoS等级：0=BestEffort 1=Silver 2=Gold 3=Platinum
PRIORITY_CLASS      = 6              # 协议标准优先级：1~8

# --------------------- 历史兼容字段 ---------------------
MAX_BW              = 20000000                      # 最大可申请带宽
PRIORITY            = 8                    # 旧版优先级字段（1-10）
COST_TOLERANCE      = 2.0              # 费用容忍度

# --------------------- 认证信息 ---------------------
USERNAME            = EFB-01                    # 用户名
CLIENT_PASSWORD     = magic123             # 客户端密码

SERVER_PASSWORD     = 1111             # 双向认证密码

# --------------------- 高级功能开关 ---------------------
TIMEOUT             = 900                     # 会话超时时间（秒）
KEEP_REQUEST        = 1                # 保持会话（长连接）
AUTO_DETECT         = 1                 # 自动探测可用链路
ACCOUNTING_ENABLED  = 1          # 启用计费

# --------------------- 流量过滤规则（TFT） ---------------------
# 格式: _iTFT=[cid,[pf_id,precedence[,src_ip.mask[,dst_ip.mask[,proto[,dst_port[,src_port]]]]]]]
#                                                                     ^字段6    ^字段7
# WiFi链路 + 卫星链路测试规则：192.168.126.5:8081 → 10.x.x.x:5880 (UDP)
# GROUND方向: 客户端(src_port=8081) → 服务器(dst_port=5880)
TFT_GROUND.1        = _iTFT=,1,10,192.168.126.5.255.255.255.255,10.3.3.6.255.255.255.255,17,5880.5880,8081.8081
TFT_GROUND.2        = _iTFT=,2,10,192.168.126.5.255.255.255.255,10.2.2.8.255.255.255.255,17,5880.5880,8081.8081

# AIR方向: 服务器(src_port=5880) → 客户端(dst_port=8081)
TFT_AIR.1           = _iTFT=,3,10,10.3.3.6.255.255.255.255,192.168.126.5.255.255.255.255,17,8081.8081,5880.5880
TFT_AIR.2           = _iTFT=,4,10,10.2.2.8.255.255.255.255,192.168.126.5.255.255.255.255,17,8081.8081,5880.5880

# --------------------- NAPT 端口映射 (ARINC 839) ---------------------
# 格式: <NAT-Type>,<Source-IP>,<Destination-IP>,<IP-Protocol>,<Destination-Port>,<Source-Port>,<to-IP>,<to-Port>
NAPT.1             = SNAT,192.168.126.5.255.255.255.255,0.0.0.0.0.0.0.0,6,80,0.65535,%LinkIp%,8080
NAPT.2             = DNAT,0.0.0.0.0.0.0.0,192.168.126.5.255.255.255.255,6,8080,0.65535,192.168.126.5,80

# --------------------- 部署说明 ---------------------
# 1. 将本文件与 efb-01.crt、efb-01.key、ca.crt 一起部署到客户端
# 2. 使用命令启动客户端：
#    ./magic_client -c fd_efb-01.conf -m efb-01_magic.conf
# 3. 如需修改带宽、QoS 等参数，请编辑上述字段后重启客户端
